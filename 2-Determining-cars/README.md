# Определение стоимости автомобилей

В нашем распоряжении исторические данные сервиса по продаже автомобиля.  
Нам нужно построить модель для определения стоимости.

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.


*Описание данных опущенно в связи с ограничениями на использование данных

## Основные шаги проекта:

+ Изучим данные. Заполним пропущенные значения и обработаем аномалии в столбцах. Если среди признаков имеются неинформативные, удалим их.  
+ Подготовим выборки для обучения моделей.  
+ Обучим разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробуем разные гиперпараметры.
+ Проанализируем время обучения, время предсказания и качество моделей.
+ Опираясь на критерии заказчика, выберем лучшую модель, проверим её качество на тестовой выборке.

### В данном проекте были проведены:

#### Первичный анализ и предобработка данных:  

+ Предобработали признаки для корректного исследования в обучении моделей,
+ Были выявлены дубликаты и пропуски в данных - данные максимально старались сохранить
+ Больше всего неприятностей доставил признак power - был заполнен после разделения выборок,  
для исключения утечки из тренировочной модели в тестовую
+ Исключены столбцы с данными - датами, некорректно выгрузились, необходимо изучить разработчикам
+ Такая же проблема со столбцом количество изображений, единственное значение в нем - 0
+ Отсутствующие значения столбцов коробка передач, тип топлива
+ Произведено логичное заполнение этих проблемных мест в датасете
+ Пропуски от 3 до 6% в столбцах тип кузова, тип топлива, модель, тип коробки передач были заполнены заглушками, которые уже присутствовали в выборке, без потери информативности, столбец repaired 17% также был заполнен заглушкой
+ Для дальнейшего исследования пришлось исключить 10% данных

Также:

+ Выявили проблемы со сбором данных с которыми мы обратимся к заказчику

#### Исследование трех моделей, также получили метрики RMSE на кросс-валидации:

+ CatBoostRegressor - не требовал преобразований, получил хорошую метрику, но достаточно долго происходило обучение
+ RandomForestRegressor - провели преобразование категориальных признаков с помощью TargetEncoder, количественных - MinMaxScaler, достаточно быстрое обучение и предсказание, по времени выигрывает именно эта модель, метрика хуже, чем у предыдущей модели
+ LightGBM - преобразовали категориальные признаки путем изменения типа на category, получилось достаточно быстрое обучение, но немного дольше, чем у модели Случайного Леса и довольной хорошее качество, ошибка меньше чем у двух предыдущих моделей

Также:

+ Проверили гипотезу об объединении признаков brand model и vehicle_type, в связи с этими преобразованиями метрика на порядок поднялась, мы отвергли эту гипотезу


## Вывод:

Мы проделали огромную в ходе проекта, а именно:  
+ Провели объемные анализ и предобработку данных,  
    + Выявили проблемные места при сборе данных, отметили в исследовании
+ Определили необходимые признаки и исключили неинформативные,
+ Выбрали три модели для исследования:
  + CatBoostRegressor
  + RandomForestRegressor
  + LightGBMRegressor
+ Для каждой модели обработали данные:
  + CatBoostRegressor - самостоятельно обрабатывает данные, поэтому для него никакой предварительной обработки не было, кроме указания категориальных признаков
  + RandomForestRegressor - преобразовали категориальные признаки с помощью TargetEncoder, а количественные - MinMaxSaler
  + Для LGBM изменили тип категориальных признаков на category
+ Обучили модели и получили их время обучения:
  + Для CatBoost это 240 секунд
  + Для RandomForest это 80 секунд
  + Для LGBM это 45 секунд
+ Оптимизировали модели по метрике MAE на кросс-валидации:
  + CatBoost - 974.32, время предсказания на тренировочной выборке - 1.82
  + RandomForest - 1005.38, время предсказания на тренировочной выборке - 7.32
  + LGBM - 948.81, время предсказания на тренировочной выборке - 28.42
+ Определили лучшую модель - LightGBMRegressor
+ С помощью нашей финальной модели получили на тестовой выборке метрику и  время предсказания:
  + RMSE: 1524.93
  + Время предсказания: 9.125 секунд
  + Наша модель превзошла бейзлайн метрику на 68.95%
  
Можем сказать что с достаточной точностью можем предсказать стоимость авто и задача решена

#### *В разработке*
##### Улучшение качества модели

В процессе исследования была изучена возможность разделения автомобилей на категории 

+ Бюджет
+ Средний
+ Премиум
+ Ретро

Что дало улучшение метрики RMSE с 1524.93 до ~500